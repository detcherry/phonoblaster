{% extends "station/root.html" %}

{% block meta %}
	<title>{{ station_proxy.station.name }}</title>
	<meta name="description" content="Listen now to {{ station_proxy.station.name }} music stream on Phonoblaster.">
{% endblock %}

{% block style %}
	<link type="text/css" rel="stylesheet" href="/static/css/station/station.css" />
{% endblock %}

{% block left-column %}
	<div class="row" id="presences" style="border:none">
		<a href="#">
			<strong class="number">0</strong>
			<span class="title">Listeners</span>
		</a>
	</div>
	<div id="presence-rows">
		<div id="admins-rows"></div>
		<div id="friends-rows"></div>
		<div id="authenticated-rows"></div>
	</div>
{% endblock %}

{% block middle-column %}
	<div class="fixed">
		<div id="station-title">
			<h2>{{ station_proxy.station.name }}</h2>
			<div class="fb-like" data-href="{{ station_proxy.station.link }}" data-send="false" data-layout="button_count"  data-show-faces="false"></div>
		</div>
		<div id="live-video">
			<div id="youtube-player"></div>
			<div id="video-settings">
				<div id="counter-left">0:00</div>
				<div id="progression-bar"><div id="filler"></div></div>
				<div id="counter-right">0:00</div>
				<div id="volume">
					<a href="#">
						<img src="/static/images/unmuted.png" id="on"/>
						<img src="/static/images/muted.png" id="off" style="display:none;"/>
					</a>
				</div>
			</div>
		</div>
		<div id="live-broadcast">
			<span class="clip">
				<!-- No image -->
			</span>
			<div class="above-title">
				<h3>Current track</h3>
			</div>
			<div class="title">
				<span class="middle">No track is being broadcast</span>
			</div>
			<div class="key_name"></div>
		</div>
	</div>
	<div id="live-comments">
		<div id="comment-box">
			{% if user_proxy %}
				{% if is_admin %}
				<img src="http://graph.facebook.com/{{ station_proxy.station.key.name }}/picture?type=square">
				{% else %}
				<img src="http://graph.facebook.com/{{ user_proxy.user.key.name }}/picture?type=square">
				{% endif %}
			{% else %}
			<img src="/static/images/unknown-listener.png">
			{% endif %}
			<form method="post" action="" id="comment">
				<input type="text" name="comment" id="comment" value="Comment..." autocomplete="off"/>
				<input type="submit" value="Comment" class="submit"/>
			</form>
		</div>
		<div id="comments-zone">
		</div>
	</div>
{% endblock %}

{% block right-column %}
<!--<div class="fixed">-->
	<div id="station-status" class="fixed">
		{% if station_proxy.on_air %}
			<span class="btn danger">On air</span>
			<p><span class="middle"><strong>{{ station_proxy.station.name }}</strong> is <em>on air</em></span></p>
		{% else %}
			<span class="btn">Off air</span>
			<p><span class="middle"><strong>{{ station_proxy.station.name }}</strong> is <em>off air</em></span></p>
		{% endif %}
		<div id="queue-status">
			<span class="grey circle"></span>
			<span class="grey circle"></span>
			<span class="grey circle"></span>
			<span class="grey circle"></span>
			<span class="grey circle"></span>
			<span class="grey circle"></span>
			<span class="grey circle"></span>
			<span class="grey circle"></span>
			<span class="grey circle"></span>
			<span class="grey circle"></span>
			<div id="queue-counter"><span>0</span>/10</div>
		</div>
	</div>
<!--</div>-->
	<ul id="tabs" class="fixed">
		<li><a href="#queue-tab" class="current">Queue</a></li>
		{% if is_admin %}
		<li style="width:86px;"><a href="#suggestions-tab" style="width:72px">Suggestions</a></li>
		<li style="width:80px;"><a href="#favorites-tab" style="width:66px">Favorites</a></li>	
		<li><a href="#library-tab">Library</a></li>
		{% endif %}
	</ul>
	<div id="tab-content-wrap">
		<div id="queue-tab" class="tab-content">
			<div id="queue-header" class="fixed">
				<span id="search-icon"></span>
				<input type="text" value="{% if is_admin %}Add a track{% else %}Suggest a track{% endif %}" id="search" autocomplete="off"/>
				<div id="search-overlay"></div>
				<div id="search-tab">
					<div class="tab-items">
					</div>
				</div>
			</div>
			<div class="tab-items">
				<div class="init">No track in the station queue</div>
			</div>
		</div>
		<div id="suggestions-tab" class="tab-content">
			<div class="tab-items">
				<div class="init">No suggestion</div>
			</div>
		</div>
		<div id="favorites-tab" class="tab-content">
			<div class="tab-items">
				<div class="init">No favorite</div>
			</div>
		</div>
		<div id="library-tab" class="tab-content">
			<div class="tab-items">
				<div class="init">No track in your library</div>
			</div>
		</div>
	</div>
{% endblock %}

{% block script %}
<!-- Pubnub -->
<div sub-key="sub-aa6b101e-24e9-11e1-ab04-3b69d50a7fd4" ssl="off" origin="pubsub.pubnub.com" id="pubnub"></div>
<script src="http://cdn.pubnub.com/pubnub-3.1.min.js"></script>
<!-- App Engine -->
<script type="text/javascript" src="/_ah/channel/jsapi"></script>
<!-- Station -->
<script type="text/javascript" src="/static/js/library/json2.js"></script>
<script type="text/javascript" src="/static/js/library/tab.js"></script>
<script type="text/javascript" src="/static/js/station/presence.js"></script>
<script type="text/javascript" src="/static/js/station/comment.js"></script>
<script type="text/javascript" src="/static/js/station/tab.js"></script>
<script type="text/javascript" src="/static/js/station/search.js"></script>
<script type="text/javascript" src="/static/js/station/status.js"></script>
<script type="text/javascript" src="/static/js/station/swfobject.js"></script>
<script type="text/javascript" src="/static/js/station/youtube.js"></script>
<script type="text/javascript" src="/static/js/station/queue.js"></script>
<script type="text/javascript" src="/static/js/station/suggestion.js"></script>
<script type="text/javascript" src="/static/js/station/station.js"></script>
<script type="text/javascript">
	/*--- Reset ---*/
	var user = null;
	var admin = false;
 	var station = null;
	/*--- User Initialization ---*/
	{% if user_proxy %} 
	user = {
		"key_name": "{{ user_proxy.user.key.name }}",
		"name": "{{ user_proxy.user.first_name }} {{ user_proxy.user.last_name }}",
	}
	{% endif %}
	/*--- Admin Initialization ---*/
	{% if is_admin %} 
	admin = true;
	{% endif %}
	/*--- Station Initialization ---*/
	station = {
		"key_name": "{{ station_proxy.station.key.name }}",
		"shortname": "{{ station_proxy.station.shortname }}",
		"name": "{{ station_proxy.station.name}}",
	}
	/*--- Station Client Initialization ---*/
	var station_client = new StationClient(user, admin, station);
</script>
{% endblock %}
