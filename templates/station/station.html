{% extends "station/root.html" %}

{% block meta %}
	<title>{{ station_proxy.station.name }}</title>
	<meta name="description" content="Listen now to {{ station_proxy.station.name }} music stream on Phonoblaster.">
{% endblock %}

{% block style %}
	<link type="text/css" rel="stylesheet" href="/static/css/station/station.css" />
	<link rel="stylesheet" href="static/plugins/fancybox/source/jquery.fancybox.css" type="text/css" media="screen"/>
{% endblock %}

{% block left-column %}
	<div class="row" id="presences" style="border:none">
		<a href="#">
			<strong class="number">0</strong>
			<span class="title">Listeners</span>
		</a>
	</div>
	<div id="presence-rows">
		<div id="admins-rows"></div>
		<div id="friends-rows"></div>
		<div id="authenticated-rows"></div>
	</div>
{% endblock %}

{% block middle-column %}
	<div class="fixed">
		<div id="station-title">
			<h2>{{ station_proxy.station.name }}</h2>
			<div class="fb-like" data-href="{{ station_proxy.station.link }}" data-send="false" data-layout="button_count"  data-show-faces="false"></div>
		</div>
		<div id="live-video">
			<div id="youtube-player"></div>
			<div id="video-settings">
				<div id="counter-left">0:00</div>
				<div id="progression-bar"></div>
				<div id="counter-right">0:00</div>
				<div id="volume"><img src="/static/images/unmuted.png"/></div>
			</div>
		</div>
		<div id="current-track">
			<span class="clip">
				<!-- No image -->
			</span>
			<div class="above-title">
				<h3>Current track</h3>
			</div>
			<div class="title">
				<span class="middle">No track is being broadcast</span>
			</div>
		</div>
	</div>
	<div id="live-comments">
		<div id="comment-box">
			{% if user_proxy %}
			<img src="http://graph.facebook.com/{{ user_proxy.user.key.name }}/picture?type=square">
			{% else %}
			<img src="/static/images/unknown-listener.png">
			{% endif %}
			<form method="post" action="" id="chat">
				<input type="text" name="comment" id="comment" value="Comment..." autocomplete="off"/>
				<input type="submit" value="Comment" class="submit"/>
			</form>
		</div>
		<div id="conversation">
		</div>
	</div>
{% endblock %}

{% block right-column %}
	<div class="fixed">
		<div id="station-status">
			{% if station_proxy.on_air %}
				<span class="btn danger">On air</span>
				<p><span class="middle"><strong>{{ station_proxy.station.name }}</strong> is <em>on air</em></span></p>
			{% else %}
				<span class="btn">Off air</span>
				<p><span class="middle"><strong>{{ station_proxy.station.name }}</strong> is <em>off air</em></span></p>
			{% endif %}
			<div id="queue-status">
				<span class="grey circle"></span>
				<span class="grey circle"></span>
				<span class="grey circle"></span>
				<span class="grey circle"></span>
				<span class="grey circle"></span>
				<span class="grey circle"></span>
				<span class="grey circle"></span>
				<span class="grey circle"></span>
				<span class="grey circle"></span>
				<span class="grey circle"></span>
				<div id="queue-counter"><span>0</span>/10</div>
			</div>
		</div>
		<ul id="tabs">
			<li><a href="#queue-tab" class="current">Queue</a></li>
			{% if is_admin %}
			<li style="width:86px;"><a href="#suggestions-tab" style="width:72px">Suggestions</a></li>
			<li style="width:80px;"><a href="#favorites-tab" style="width:66px">Favorites</a></li>	
			<li><a href="#library-tab">Library</a></li>
			{% endif %}
		</ul>
	</div>
	<div id="tab-content-wrap">
		<div id="queue-tab" class="tab-content">
			<div id="queue-header" class="fixed">
				{% if is_admin %}
				<span id="search-icon"></span><input type="text" value="Add a track" id="search-add"/>
				{% else %}
				<span id="search-icon"></span><input type="text" value="Suggest a track" id="search-suggest"/>
				{% endif %}
			</div>
			<div class="tab-items">
				<div class="init">No track in the station queue</div>
			</div>
		</div>
		<div id="suggestions-tab" class="tab-content">
			<div class="tab-items">
				<div class="init">No suggestion</div>
			</div>
		</div>
		<div id="favorites-tab" class="tab-content">
			<div class="tab-items">
				<div class="init">No favorite</div>
			</div>
		</div>
		<div id="library-tab" class="tab-content">
			<div class="tab-items">
				<div class="init">No track in your library</div>
			</div>
		</div>
	</div>
{% endblock %}

{% block script %}
<!-- Pubnub -->
<div sub-key="sub-aa6b101e-24e9-11e1-ab04-3b69d50a7fd4" ssl="off" origin="pubsub.pubnub.com" id="pubnub"></div>
<script src="http://cdn.pubnub.com/pubnub-3.1.min.js"></script>
<!-- App Engine -->
<script type="text/javascript" src="/_ah/channel/jsapi"></script>
<!-- Station -->
<script type="text/javascript" src="/static/js/library/json2.js"></script>
<script type="text/javascript" src="/static/js/station/tab.js"></script>
<script type="text/javascript" src="static/plugins/fancybox/source/jquery.fancybox.pack.js"></script>
<script type="text/javascript" src="/static/js/station/station.js"></script>
<script type="text/javascript">
	/*--- Reset ---*/
	var user = null;
	var admin = false;
 	var station = null;
	/*--- User Initialization ---*/
	{% if user_proxy %} 
	user = {
		"key_name": "{{ user_proxy.user.key.name }}",
		"first_name": "{{ user_proxy.user.first_name }}",
		"last_name": "{{ user_proxy.user.last_name }}",
	}
	{% endif %}
	/*--- Admin Initialization ---*/
	{% if is_admin %} 
	admin = true;
	{% endif %}
	/*--- Station Initialization ---*/
	station = {
		"key_name": "{{ station_proxy.station.key.name }}",
		"shortname": "{{ station_proxy.station.shortname }}",
		"name": "{{ station_proxy.station.name}}",
	}
	/*--- Station Client Initialization ---*/
	var station_client = new StationClient(user, admin, station);
</script>
{% endblock %}
